window.addEventListener("DOMContentLoaded",(function(){const t=document.querySelector("body");if(t.classList.contains("admin"))return;let e={};const i={method:"GET"};let n;(async function(){try{const t=await fetch("/index.php?option=com_chirp&task=api.settings",i);return await t.json()}catch(t){}})().then((t=>{e=t})),new EventSource("/plugins/behaviour/chirp/event.php").addEventListener("alert",(t=>{n!==t.type&&s(JSON.parse(t.data)),n=t.type}));const s=i=>{const n=new Audio(`/media/plg_system_chirp/wav/${e.notificationsound}.wav`);let s,o,r,a;const c=document.createElement("div");c.classList.add("chirp"),s="string"==typeof i.userName&&i.userName.includes(" ")?i.userName.split(" ")[0]:i.userName,o="string"!=typeof i.userCity?"":` from ${i.userCity}`,a="string"==typeof i.productName&&["a","e","i","o","u"].some((t=>i.productName[0]===t))?"an":"a",r=`${s}${o} ordered ${a} <a href='${i.productLink}'><strong>${i.productName}</strong></a>!`,c.innerHTML=`\n            <div id='chirpProductImage'><img src='${i.productImage}' alt='' /></div>\n            <div id='chirpTopLine'>${r}</div>\n            <div id='chirpBottomLine'>Just Now</div>\n            <div class="wrapper" style="--animation-duration: ${e.chirpshowlength}s">\n            <div class="pie spinner"></div>\n            <div class="pie filler"></div>\n            <div class="mask"></div>\n            </div> \n            `,t.prepend(c),c.addEventListener("click",(()=>{c.classList.remove("showChirp"),((t,e)=>{if("object"==typeof t&&"string"==typeof e){const i={returnData:t,uniqId:e},n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)};try{fetch("/index.php?option=com_chirp&task=api.track",n)}catch(t){}}})(i,Date.now().toString(36)+Math.random().toString(36).substring(2,15))})),setTimeout((()=>{(()=>{switch(c.style.left="unset",c.style.right="unset",c.style.top="unset",c.style.bottom="unset",e.notificationlocation){case"top-left":c.style.top="20px",c.style.left="20px";break;case"top-center":c.style.top="20px",c.style.left=`calc(50vw - ${c.getBoundingClientRect().width/2}px)`;break;case"top-right":c.style.top="20px",c.style.right="20px";break;case"center-right":c.style.top=window.innerHeight/2-c.getBoundingClientRect().height/2+"px",c.style.right="20px";break;case"bottom-right":c.style.bottom="20px",c.style.right="20px";break;case"bottom-center":c.style.bottom="20px",c.style.left=`calc(50vw - ${c.getBoundingClientRect().width/2}px)`;break;case"bottom-left":c.style.left="20px",c.style.bottom="20px";break;case"center-left":c.style.top=window.innerHeight/2-c.getBoundingClientRect().height/2+"px",c.style.left="20px";break}})(),c.classList.add("showChirp"),e.sound&&n.play()}),1e3),setTimeout((()=>{c.classList.remove("showChirp")}),1e3*e.chirpshowlength)}}));